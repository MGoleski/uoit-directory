<!-- tabs title start -->
<ul class="tabs" data-tabs="" id="tab1" role="tablist">
  <li class="tabs-title is-active" role="presentation" id="searchTab" ng-click="$ctrl.removeSearchResult()">
    <a href="#tab1-1" role="tab" aria-controls="tab1-1" aria-selected="true" id="tab1-1-label">Search</a>
  </li>
  <li class="tabs-title" role="presentation" id="contactsTab" ng-click="$ctrl.removeSearchResult()">
    <a href="#tab1-2" role="tab" aria-controls="tab1-2" aria-selected="false" id="tab1-2-label">Contacts</a>
  </li>
  <li class="tabs-title" role="presentation" id="updateTab" ng-click="$ctrl.removeSearchResult()">
    <a href="#tab1-3" role="tab" aria-controls="tab1-3" aria-selected="false" id="tab1-3-label">Update</a>
  </li>
</ul>
<!-- tabs title end -->
<!-- tabs content start -->
<div class="tabs-content" data-tabs-content="tab1" id="tab1-content">
  <!-- TAB 1 STARTS  -->
  <div class="tabs-panel is-active" id="tab1-1" role="tabpanel" aria-hidden="false" aria-labelledby="tab1-1-label">
    <div class="row">
      <div class="small-12 columns">
        <!-- TAB TITLE  -->
        <h2>Search</h2>
        <br/>
        <p>Enter a first name, a last name, or a department to find a Faculty or Staff member. Partial names can also be used.</p>
      </div>
    </div>
    <!-- INPUT FIELDS FOR FIRST NAME, LAST NAME, AND DEPARTMENT -->
    <form>
      <div class="row">
        <div class="small-12 medium-3 columns">
          <label>First Name:
          <input type="text" ng-model="searchName.firstname" ng-change="$ctrl.modifyResultResetDropdown()" />
          <span class="form-error" style="display:block;" ng-show="userError">
          {{ userError }}
          </span>
          </label>
        </div>
        <div class="small-12 medium-3 columns">
          <label>Last Name:
          <input type="text" ng-model="searchName.lastname" ng-change="$ctrl.modifyResultResetDropdown()" />
          <span class="form-error" style="display:block;" ng-show="userError">
          {{ userError }}
          </span>
          </label>
        </div>
        <div class="small-12 medium-3 columns">
          <label for="">
            Select Department:
            <!-- SEARCH DEPARTMENT BY INPUT FIELD -->
            <select ng-show="departments" ng-model="searchName.department" ng-options="department for department in departments" ng-change="$ctrl.modifyResultClearInput()">
              <option value="">Select Department</option>
            </select>
            <select ng-hide="departments" disabled>
              <option value="">Loading departments&hellip;</option>
            </select>
            <span class="form-error" style="display:block;" ng-show="departmentError">
            {{ departmentError }}
            </span>
          </label>
        </div>
        <div class="small-12 small-centered medium-3 columns" ng-if="searchName.department || searchName.lastname || searchName.firstname">
          <button class="button results-button" ng-click="$ctrl.smoothScroll()">
          <span ng-show="users && users.length">Results below &nbsp;<span class="icon_arrow_down bounce"></span></span>
          <span ng-hide="users.length">Loading results...</span>
          </button>
        </div>
      </div>
    </form>
  </div>
  <!-- TAB 1 END  -->
  <!-- TAB 2 STARTS -->
  <div class="tabs-panel" id="tab1-2" role="tabpanel" aria-hidden="true" aria-labelledby="tab1-2-label">
    <div ng-repeat="group in contacts">
      <h3>{{ ::group.category }}</h3>
      <div class="row">
        <span ng-repeat="contact in group.items" class="small-6 large-6 medium-6 columns contact-card{{ ::(contact.class ? ' contact-faculty ' + contact.class : '') }}">
          <p class="contact-name"><strong>{{ ::contact.name }}</strong></p>
          <p class="contact-phone"><a href="tel:{{ ::contact.phone | tel }}" title="Place call to {{ ::contact.phone | tel }}">{{ ::contact.phone }}</a></p>
        </span>
      </div>
    </div>
  </div>
  <!-- TAB 2 END  -->
  <!-- TAB 3 STARTS  -->
  <div class="tabs-panel " id="tab1-3" role="tabpanel" aria-hidden="true" aria-labelledby="tab1-3-label">
    <!-- TAB TITLE  -->
    <h2>Update Information</h2>
    <br/>
    <p>If you are a Faculty or Staff member you can have your directory information updated by filling out the form below.</p>
    <!-- SHOW ERROR/SUCCESS MESSAGES -->
    <div ng-show="formStatus.success || formStatus.error" class="callout" ng-class="{ success: formStatus.success, alert: formStatus.error }" data-closable>
      {{ formStatus.success || formData.error }}
      <button class="close-button" aria-label="Dismiss alert" type="button" data-close>
      <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <!-- FORM -->
    <form ng-submit="processForm()" name="updateForm">
      <div class="row">
        <div class="small-12 medium-12 columns">
          <label>BANNER USER ID:<span class="red"> *</span>
          <input type="text" name="bannerId" ng-model="formData.bannerId" required/>
          </label>
        </div>
      </div>
      <div class="row">
        <div class="small-12 medium-6 columns">
          <label>FIRST NAME:<span class="red"> *</span>
          <input type="text" name="firstName" ng-model="formData.firstName" required/>
          </label>
        </div>
        <div class="small-12 medium-6 columns">
          <label>LAST NAME:<span class="red"> *</span>
          <input type="text" name="lastName" ng-model="formData.lastName" required/>
          </label>
        </div>
      </div>
      <div class="row">
        <div class="small-12 medium-6 columns">
          <label>DEPARTMENT:<span class="red"> *</span>
          <input type="text" name="department" ng-model="formData.department" required/>
          </label>
        </div>
        <div class="small-12 medium-6 columns">
          <label>TITLE:<span class="red"> *</span>
          <input type="text" name="title" ng-model="formData.title" required/>
          </label>
        </div>
      </div>
      <div class="row">
        <div class="small-12 medium-6 columns">
          <label>BUILDING:<span class="red"> *</span>
          <input type="text" name="building" ng-model="formData.building" required/>
          </label>
        </div>
        <div class="small-12 medium-6 columns">
          <label>OFFICE:<span class="red"> *</span>
          <input type="text" name="office" ng-model="formData.office" required/>
          </label>
        </div>
      </div>
      <div class="row">
        <div class="small-12 medium-6 columns">
          <label>EXTENSION:<span class="red"> *</span>
          <input type="text" name="extension" ng-model="formData.extension" required/>
          </label>
        </div>
        <div class="small-12 medium-6 columns">
          <label>E-MAIL:<span class="red"> *</span>
          <input type="email" name="email" ng-model="formData.email" required/>
          </label>
        </div>
      </div>
      <fieldset class="large-6 columns">
        <button class="button" type="submit" value="Submit" role="button">Submit</button>
      </fieldset>
    </form>
  </div>
</div>
<!-- DISPLAY ANGULAR SEARCH RESULT IN CALLOUT/SERPERATE TAB  -->
<div class="callout" id="search-results" ng-if="searchName.department || searchName.lastname || searchName.firstname">
  <div class="search-list">
    <div class="row">
      <div class="xxsmall-12 small-6 columns">
        <h3>Directory Search Results</h3>
      </div>
      <div class="xxsmall-12 small-6 columns" ng-show="users.length">
        <div class="tiny button-group align-right">
          <div class="flex-container align-middle">
            <label id="sort_by">Sort by: &nbsp;</label>
          </div>
          <button id="sort_firstname" class="button" ng-click="$ctrl.sortBy('firstname')" ng-class="{hollow: order !== 'firstname'}" aria-labelledby="sort_by sort_firstname">First name</button>
          <button id="sort_lastname" class="button" ng-click="$ctrl.sortBy('lastname')" ng-class="{hollow: order !== 'lastname'}" aria-labelledby="sort_by sort_lastname">Last name</button>
          <button id="sort_department" class="button" ng-click="$ctrl.sortBy('department')" ng-class="{hollow: order !== 'department'}" aria-labelledby="sort_by sort_department">Department</button>
        </div>
      </div>
      <div class="xxsmall-12 columns">
        <p class="lead" ng-hide="(currentPage + 1) > $ctrl.numberOfPages()">To reach a Faculty or Staff member dial the main switchboard at 905.721.8668 and ask for the extension listed.</p>
        <p class="lead" ng-show="(currentPage + 1)> $ctrl.numberOfPages()">Sorry, no directory search results to display.</p>
      </div>
    </div>
  </div>
  <!-- FILTER / REPEAT / DISPLAY BASED ON WHAT THE USER TYPES -->
  <ul class="accordion" data-accordion data-allow-all-closed="true">
    <!-- SEARCH DEPARTMENT BY INPUT FIELD -->
    <li class="accordion-item" data-accordion-item ng-repeat="user in users | filter: searchName |  orderBy: order | startFrom:currentPage*pageSize | limitTo:pageSize">
      <!-- SEARCH DEPARTMENT BY DROPDOWN -->
      <a class="accordion-title" ng-click="showDetails = ! showDetails; showDetails && $ctrl.getUser(user)">
        {{::user.firstname}} {{::user.lastname}}
        <ul class="accordion-title-desc">
          <li>
            <strong>Department:</strong>
            {{::user.department}}
          </li>
          <li>
            <strong>Title:</strong>
            {{::user.position}}
          </li>
        </ul>
      </a>
      <div class="a-content" ng-class="{ 'hidden': ! showDetails }" data-tab-content>
        <ul class="search-list-info">
          <li>
            <strong>Building:</strong>
            {{::user.building}}
          </li>
          <li>
            <strong>Office:</strong>
            {{::user.office}}
          </li>
          <li>
            <strong>Extension:</strong>
            {{::user.extension}}
          </li>
          <li>
            <strong>E-mail:</strong>
            <a href="mailto:{{::user.email}}">{{::user.email | lowercase}}</a>
          </li>
        </ul>
        <div ng-if="user.expert">
          <hr/>
          <small ng-hide="user.expert.username">
          <em class="subheader">Checking for Expert profile...</em>
          </small>
          <div class="expert-profile media-object" ng-show="user.expert.username">
            <div class="media-object-section">
              <div class="thumbnail">
                <img ng-src="{{ user.expert.url }}" alt="Photo of {{ user.expert.firstname }} {{ user.expert.lastname }}">
              </div>
            </div>
            <div class="media-object-section main-section">
              <div class="row align-middle">
                <div class="column">
                  <h4>{{ user.expert.firstname }} {{ user.expert.lastname }} <small class="subheader">on UOIT Expert Centre</small></h4>
                  <p class="expert-profile-topics"><a ng-repeat="topic in user.expert.topics" ng-href="https://uoit.ca/expertcentre?q={{topic.name}}" class="label tertiary">{{ topic.name }}</a></p>
                  <p>{{ user.expert.tagline }}</p>
                </div>
                <div class="column shrink">
                  <a ng-href="https://uoit.ca/expertcentre/expert/{{user.expert.username}}" class="button hollow">View full profile</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </li>
  </ul>
  <!-- PAGINATION - FUNCTIONAL -->
  <div class="text-center pagination-container">
    <ul class="pagination" role="navigation" aria-label="Pagination" ng-hide="(currentPage + 1) > $ctrl.numberOfPages()">
      <li class="pagination-previous">
        <a role="button" ng-class="{ disabled: (currentPage == 0) }" ng-click="!(currentPage == 0) && $ctrl.changePageAndScroll(-1)">
        <span class="icon_arrow_left"></span>
        Previous <span class="show-for-sr">page</span>
        </a>
      </li>
      <li ng-repeat="page in $ctrl.getPageNumbers()">
        <a aria-label="Page {{ page }}" ng-click="$ctrl.gotoPageAndScroll(page)" ng-class="{ current: (currentPage + 1) === page }">
        <span ng-show="(currentPage + 1) === page" class="show-for-sr">currently viewing</span>
        <span class="show-for-sr">page</span>{{ page }}
        </a>
      </li>
      <li class="pagination-next">
        <a role="button" ng-class="{ disabled: ((currentPage + 1) >= $ctrl.numberOfPages()) }" ng-click="!((currentPage + 1) >= $ctrl.numberOfPages()) && $ctrl.changePageAndScroll(1)">
        Next <span class="show-for-sr">page</span>
        <span class="icon_arrow_right"></span>
        </a>
      </li>
    </ul>
    <span class="label tertiary">
    {{currentPage+1}} out of {{$ctrl.numberOfPages()}}
    </span>
  </div>
</div>